define(["TFS/WorkItemTracking/RestClient","TFS/WorkItemTracking/Contracts","q"],function(e,t,n){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(t,n){t.exports=e},function(e,n){e.exports=t},,,function(e,t){e.exports=n},,function(e,t,n){var r,i;r=[n,t,n(0),n(1),n(4)],void 0!==(i=function(e,t,n,r,i){"use strict";function o(e){return f.getWorkItems(e,void 0,void 0,r.WorkItemExpand.Fields)}function s(){return f.getFields()}function c(e){return l.then(function(t){return t.getValue("wiprint-"+e.fields["System.WorkItemType"].sanitize(),{scopeType:"user",defaultValue:p}).then(function(e){return e.length>0?e:p})})}function u(e){return"TEAM FOUNDATION"===m.account.name?f.getHistory(e.id).then(function(e){return e.map(function(e){return{revisedBy:e.revisedBy,revisedDate:e.revisedDate,revision:e.rev,text:e.value}})}):f.getComments(e.id).then(function(e){return e.comments})}function a(e){return e.map(function(t,n){return i.all([c(t),u(t),s()]).then(function(e){return e}).spread(function(r,i,o){var s="";n%6==0&&(s+='<div class="row mb-4 row-height">'),n%6==3&&(s+='<div class="row row-height">');var c=t.fields["System.Description"]||"";return s+='<div class="col-sm-4">\n                                <div class="border">\n                                    <div class="pl-3 pr-3 pt-3 clearfix">\n                                        <div class="float-left">\n                                            <div>\n                                                <strong>'+(t.fields["System.Id"]||"")+'</strong>\n                                            </div>\n                                        </div>\n                                        <div class="float-right">\n                                            <div>\n                                                <em>'+(t.fields["System.IterationPath"]||"")+'</em>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <hr />\n                                    <h5 class="pl-2 pr-2 text-center">'+(t.fields["System.Title"]||"")+'</h4>\n                                    <div class="pl-2 pr-2 text-justify row-desc-height" style="font-size: 10px;">'+c+'</div>\n                                    <hr />\n                                    <div class="pl-3 pr-3 pb-3 clearfix">\n                                        <div class="float-left">\n                                            <div> Point: '+(t.fields["Microsoft.VSTS.Scheduling.Effort"]||"")+' </div>\n                                        </div>\n                                        <div class="float-right">\n                                            <div> Priority: '+(t.fields["Microsoft.VSTS.Common.Priority"]||"")+" </div>\n                                        </div>\n                                    </div>\n                                </div>\n                              </div>",(n%6==2||n===e.length-1&&n%6<2)&&(s+="</div>"),(n%6==5||n===e.length-1&&n%6>=3&&n%6<5)&&(s+='</div><div class="page-break"></div>'),s})})}Object.defineProperty(t,"__esModule",{value:!0});var d=VSS.getExtensionContext(),l=VSS.getService(VSS.ServiceIds.ExtensionData),m=VSS.getWebContext(),f=n.getClient(),p=[{name:"Assigned To",referenceName:"System.AssignedTo"},{name:"State",referenceName:"System.State"},{name:"Created Date",referenceName:"System.CreatedDate"},{name:"Description",referenceName:"System.Description"},{name:"Acceptance Criteria",referenceName:"Microsoft.VSTS.Common.AcceptanceCriteria"},{name:"History",referenceName:"System.History"}];String.prototype.sanitize=function(){return this.replace(/\s/g,"-").replace(/[^a-z0-9\-]/gi,"")},String.prototype.htmlize=function(){return this.replace(/<\/*(step|param|desc|comp)(.*?)>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")};var g={getMenuItems:function(e){var t="Print";return e.workItemIds&&e.workItemIds.length>1&&(t="Print Selection"),[{action:function(e){return o(e.workItemIds||e.ids||[e.workItemId||e.id]).then(function(e){return a(e)}).then(function(e){return i.all(e)}).then(function(e){var t=e.reduce(function(e,t){return e+t});document.getElementById("workitems").innerHTML+=t,console.log(t),window.focus(),document.execCommand("print",!1,null)||window.print(),document.getElementById("workitems").innerHTML=""})},icon:"static/img/print14.png",text:t,title:t}]}},v={getMenuItems:function(e){return[{action:function(e){return f.queryByWiql({query:e.query.wiql},m.project.name,m.team.name).then(function(e){return e.workItemRelations?e.workItemRelations.map(function(e){return e.target.id}):e.workItems.map(function(e){return e.id})}).then(function(e){return o(e).then(function(e){return a(e)}).then(function(e){return i.all(e)}).then(function(e){var t=e.reduce(function(e,t){return e+t});document.getElementById("workitems").innerHTML+=t,window.focus(),document.execCommand("print",!1,null)||window.print(),document.getElementById("workitems").innerHTML=""})})},icon:"static/img/print16.png",text:"Print All",title:"Print All"}]}};VSS.register(d.publisherId+"."+d.extensionId+".print-work-item",g),VSS.register(d.publisherId+"."+d.extensionId+".print-query-toolbar",v),VSS.register(d.publisherId+"."+d.extensionId+".print-query-menu",v),VSS.register("print-work-item",g),VSS.register("print-query-menu",v)}.apply(t,r))&&(e.exports=i)}])});
//# sourceMappingURL=wiprint.js.map